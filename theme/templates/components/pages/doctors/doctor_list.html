{% extends "base.html" %}
{% load static %}

{% block title %}Doctor List{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6 text-gray-600 dark:text-gray-400">Doctor List</h1>

    <form method="get" class="flex items-center mb-6">
        <input type="text" name="search" placeholder="Search doctors..." value="{{ search_query }}" class="form-input w-full mr-2 bg-white dark:bg-neutral-700 text-gray-600 dark:text-gray-400 border-primary-300 dark:border-primary-600" />
        <button type="submit" class="bg-primary-500 hover:bg-primary-600 dark:bg-primary-600 dark:hover:bg-primary-700 text-neutral-800 font-bold py-2 px-4 rounded">
            Search
        </button>
    </form>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
        <form method="get" class="flex flex-col space-y-4">
            <input type="hidden" name="search" value="{{ search_query }}" />
            <input type="hidden" name="page" value="{{ page_obj.number }}" />

            <div class="flex items-center">
                <label for="gender" class="mr-2 text-gray-600 dark:text-gray-400">Gender:</label>
                <select name="gender" id="gender" class="form-select w-full bg-white dark:bg-neutral-700 text-gray-600 dark:text-gray-400 border-primary-300 dark:border-primary-600" onchange="this.form.submit()">
                    <option value="">All</option>
                    <option value="M" {% if gender_filter == 'M' %}selected{% endif %}>Male</option>
                    <option value="F" {% if gender_filter == 'F' %}selected{% endif %}>Female</option>
                </select>
            </div>

            <div class="flex items-center">
                <label for="specialty" class="mr-2 text-gray-600 dark:text-gray-400">Specialty:</label>
                <select name="specialty" id="specialty" class="form-select w-full bg-white dark:bg-neutral-700 text-gray-600 dark:text-gray-400 border-primary-300 dark:border-primary-600" onchange="this.form.submit()">
                    <option value="">All</option>
                    {% for specialty in specialties %}
                        <option value="{{ specialty.name }}" {% if specialty_filter == specialty.name %}selected{% endif %}>{{ specialty.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="flex items-center">
                <label for="items_per_page" class="mr-2 text-gray-600 dark:text-gray-400">Items per page:</label>
                <select name="items_per_page" id="items_per_page" class="form-select w-full bg-white dark:bg-neutral-700 text-gray-600 dark:text-gray-400 border-primary-300 dark:border-primary-600" onchange="this.form.submit()">
                    {% for option in items_per_page_options %}
                        <option value="{{ option }}" {% if items_per_page == option %}selected{% endif %}>{{ option }}</option>
                    {% endfor %}
                </select>
            </div>
        </form>
    </div>

    <div class="bg-primary-500 dark:bg-neutral-700 shadow-md rounded-lg overflow-hidden">
        <table class="min-w-full leading-normal">
            <thead>
                <tr>
                    <th class="px-5 py-3 border-b-2 border-primary-200 dark:border-primary-700 bg-primary-100 dark:bg-primary-800 text-left text-xs font-semibold text-primary-600 dark:text-primary-200 uppercase tracking-wider">
                        Name
                    </th>
                    <th class="px-5 py-3 border-b-2 border-primary-200 dark:border-primary-700 bg-primary-100 dark:bg-primary-800 text-left text-xs font-semibold text-primary-600 dark:text-primary-200 uppercase tracking-wider">
                        Specialty
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for doctor in page_obj %}
                <tr>
                    <td class="px-5 py-5 border-b border-primary-200 dark:border-primary-700 bg-white dark:bg-neutral-700 text-sm">
                        <a href="{% url 'doctor-detail' doctor.pk %}" class="text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">
                            {{ doctor.provider_first_name }} {{ doctor.provider_last_name }}
                        </a>
                    </td>
                    <td class="px-5 py-5 border-b border-primary-200 dark:border-primary-700 bg-white dark:bg-neutral-700 text-sm text-gray-600 dark:text-gray-400">
                        {% if doctor.primary_specialty.image %}
                            <img src="{{ doctor.primary_specialty.image.url }}" alt="{{ doctor.primary_specialty.name }}" class="w-8 h-8 inline-block mr-2 dark:invert">
                        {% endif %}
                        {{ doctor.primary_specialty.name }}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="2" class="px-5 py-5 border-b border-primary-200 dark:border-primary-700 bg-white dark:bg-neutral-700 text-sm text-center text-gray-600 dark:text-gray-400">
                        No doctors found.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    {% if page_obj.has_other_pages %}
    <div class="flex justify-center mt-6">
        {% include 'components/molecules/pagination.html' %}
    </div>
    {% endif %}
</div>
{% endblock %}
