<!-- theme/templates/base.html -->
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block meta_description %}LangLessPatientComm - Improving healthcare communication{% endblock %}">
    <title>{% block title %}LangLessPatientComm{% endblock %}</title>

    <!-- Preload critical assets -->
    <link rel="preload" href="{% static 'css/dist/styles.css' %}" as="style">
    <link rel="preload" href="{% static 'js/main.js' %}" as="script">

    <!-- Inline critical dark mode script to prevent flickering -->
    <script>
        (function() {
            const darkMode = localStorage.getItem('darkMode') === 'true' ||
                (!('darkMode' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            document.documentElement.classList.toggle('dark', darkMode);
        })();
    </script>

    <!-- Load the main CSS file -->
    <link rel="stylesheet" href="{% static 'css/dist/styles.css' %}">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{% static 'images/favicon.png' %}">

    <!-- Custom CSS -->
    {% block custom_css %}{% endblock %}

    <!-- Deferred loading of non-critical scripts -->
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin" defer></script>
    <script src="{% static 'js/tinymce_setup.js' %}" defer></script>
</head>
<body class="bg-primary-50 dark:bg-primary-900 dark:text-primary-50 flex flex-col min-h-screen">
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 bg-primary-600 text-white p-2">
        Skip to main content
    </a>

    {% include 'components/molecules/header.html' %}

    <nav class="py-4" aria-label="Breadcrumb">
        <div class="container mx-auto px-4">
            <ol class="flex flex-wrap space-x-2 rounded-md bg-primary-100 dark:bg-primary-800 px-6 py-2 shadow" role="list">
                <li class="flex items-center">
                    <a href="{% url 'home' %}" class="text-primary-600 dark:text-primary-300 hover:text-primary-700 dark:hover:text-primary-200 flex items-center">
                        <svg class="h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                            <path fill-rule="evenodd" d="M9.293 2.293a1 1 0 011.414 0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z" clip-rule="evenodd"/>
                        </svg>
                        <span class="ml-1">Home</span>
                    </a>
                </li>
                {% block breadcrumbs %}{% endblock %}
            </ol>
        </div>
    </nav>

    <main id="main-content" class="flex-grow container mx-auto px-4 py-8">
        {% block content %}{% endblock %}
    </main>

    {% include 'components/molecules/footer.html' %}

    <!-- Main JavaScript file -->
    <script src="{% static 'js/main.js' %}" defer></script>

    <!-- Custom JavaScript -->
    {% block custom_js %}{% endblock %}
</body>
</html>